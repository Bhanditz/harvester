%h1
  Harvest for
  = link_to(@harvest.resource.name, @harvest.resource)
  Created
  = l(@harvest.created_at, format: :short)
- if @harvest.fetched_at
  %strong Fetched:
  = l(@harvest.fetched_at, format: :short)
- if @harvest.validated_at
  %strong Validated:
  = l(@harvest.validated_at, format: :short)
- if @harvest.deltas_created_at
  %strong Delats Created
  = l(@harvest.deltas_created_at, format: :short)
- if @harvest.linked_at
  %strong Linked:
  = l(@harvest.linked_at, format: :short)
- if @harvest.units_normalized_at
  %strong Units Normalized:
  = l(@harvest.units_normalized_at, format: :short)
- if @harvest.ancestry_built_at
  %strong Ancestry Built:
  = l(@harvest.ancestry_built_at, format: :short)
- if @harvest.nodes_matched_at
  %strong Nodes Matched:
  = l(@harvest.nodes_matched_at, format: :short)
- if @harvest.names_parsed_at
  %strong Names Parsed:
  = l(@harvest.names_parsed_at, format: :short)
- if @harvest.consistency_checked_at
  %strong Consistency Checked:
  = l(@harvest.consistency_checked_at, format: :short)
- if @harvest.stored_at
  %strong Stored:
  = l(@harvest.stored_at, format: :short)
- if @harvest.indexed_at
  %strong Indexed:
  = l(@harvest.indexed_at, format: :short)
- if @harvest.failed_at
  %strong Failed:
  = l(@harvest.failed_at, format: :short)
- if @harvest.completed_at
  %strong Completed:
  = l(@harvest.completed_at, format: :short)
- if @harvest.time_in_minutes
  = "(took #{@harvest.time_in_minutes} minutes)"

%h2 Expected File Format Definitions
- if @harvest.formats.empty?
  "This harvest has no file format definitions yet, and cannot be processed."
- else
  %ul
    - @harvest.formats.each do |fmt|
      %li
        %strong= "#{link_to(fmt.represents, fmt)}:".html_safe
        = fmt.file ? fmt.file : fmt.get_from
        - if fmt.excel?
          = ", sheet ##{fmt.sheet}"
        = "(#{fmt.fields.size} fields)"

%h2 Harvesting Log
- if @harvest.hlogs.empty?
  %p The logs for this harvest are empty.
- else
  %ul
    - @harvest.hlogs.order(:created_at).each do |log|
      %li
        %strong= log.category
        = log.message
        - if log.line?
          = "(on line #{log.line})"
